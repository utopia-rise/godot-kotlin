name: Check PR - codegen-uptodate
on: pull_request

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Checkout submodules
        uses: snickerbockers/submodules-init@v4
      - name: Set up JDK 11
        uses: actions/setup-java@v1
        with:
          java-version: 11
      - uses: eskatos/gradle-command-action@v1
        with:
          arguments: godot-library:generateAPI
      - run: |
          if [ -n "$(git status --porcelain)" ]; then
            echo "Generated code is stale, please commit them!"
            exit 1
          fi